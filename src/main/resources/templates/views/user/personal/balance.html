<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <title>个人理财系统</title>
  <!-- 引入bootstrap样式 -->
  <link th:href="@{/bootstrap/css/bootstrap.css}" rel="stylesheet" type="text/css">
  <!--图标库-->
  <link th:href="@{/lyear/css/materialdesignicons.min.css}" rel="stylesheet" type="text/css"/>
  <!--弹出框样式-->
  <link th:href="@{/lyear/jconfirm/jquery-confirm.min.css}" rel="stylesheet" type="text/css"/>
  <!--自定义样式-->
  <link href="../lyear/css/style.min.css" th:href="@{/lyear/css/style.min.css}" rel="stylesheet" type="text/css"/>
</head>
<body>
<div class="lyear-layout-web">
  <div class="lyear-layout-container">
    <!--左侧导航-->
    <div th:replace="user/common/leftbar::#leftbaraside"></div>
    <!--头部信息-->
    <div th:replace="user/common/topbar::#topbarheader"></div>

    <!--页面主要内容-->
    <main class="lyear-layout-content">
      <div class="container-fluid">
        <div class="row">
          <div class="col-lg-12">
            <div class="card">
              <div class="card-header">
                <h4>账户余额</h4>
              </div>

              <div class="card-body">
                <form id="profileForm" class="site-form">
                  <div class="form-group">
                      <label>账户名称</label>
                      <input type="text" class="form-control" name="username" id="username"
                             th:value="${session.loginUser.username}" disabled="disabled">
                  </div>
                  <div class="form-group">
                    <label>账户余额</label>
                    <input type="text" class="form-control" name="balance" id="balance"
                           th:value="${Balance.balance}" disabled="disabled">
                  </div>
                  <div class="form-group">
                    <button class="btn btn-primary" id="recharge" type="button">充值</button>
                    <button class="btn btn-primary" id="withdraw_deposit" type="button">提现</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <!--End 页面主要内容-->
  </div>
</div>

<!-- 引入jQuery和bootstrap的js -->
<script th:src="@{/js/jquery.js}"></script>
<script th:src="@{/bootstrap/js/bootstrap.js}"></script>
<!--滚动条插件-->
<script th:src="@{/lyear/js/perfect-scrollbar.min.js}"></script>
<!--弹出框js-->
<script th:src="@{/lyear/jconfirm/jquery-confirm.min.js}"></script>
<!--自定义js脚本-->
<script th:src="@{/lyear/js/main.min.js}"></script>
<script type="text/javascript">
  $("#recharge").click(function (){
    checkBankCard();
  });

  //检查用户是否有银行卡
  function checkBankCard(){
    var userId=[[${session.loginUser.id}]];
    $.ajax({
      url: "/user/getBankCardByUserId/" + userId,
      type: "GET",
      success: function (result) {
        if (result.code === 100) {
          console.log(result.extend.bankCardList);
          if (result.extend.bankCardList.length ==0){
            $.alert('请添加银行卡,5秒后将自动跳转银行卡界面');
            setTimeout(function () {
              location.href = "/user/personal/toBankCard.html";
            }, 5000);
          }
        }
        else {
          $.alert('查询名下银行卡失败');
        }
      }
    })
  }
</script>
</body>
</html>